{{#if error}}
<div class="auth-error">{{error}}</div>
{{/if}}

{{#if success}}
<div class="auth-success">{{success}}</div>
{{/if}}

<h2 class="auth-subtitle">Set Up Two-Factor Authentication</h2>

{{#if recoveryCodes}}
<div style="background: #fffbeb; border: 1px solid #fde68a; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
  <p style="font-weight: 600; color: #92400e; margin-bottom: 0.5rem;">Save your recovery codes!</p>
  <p style="font-size: 0.8rem; color: #92400e; margin-bottom: 0.75rem;">
    These codes can be used to access your account if you lose your authenticator. Each code can only be used once.
  </p>
  <div style="background: white; border-radius: 4px; padding: 0.75rem; font-family: monospace; font-size: 0.9rem; column-count: 2; column-gap: 1rem;">
    {{#each recoveryCodes}}
    <div style="margin-bottom: 0.25rem;">{{this}}</div>
    {{/each}}
  </div>
</div>
<a href="/realms/{{realmName}}/account" class="btn-primary" style="display: block; text-align: center; text-decoration: none;">Done</a>
{{else}}
<p style="color: #6b7280; font-size: 0.85rem; margin-bottom: 1rem; text-align: center;">
  Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)
</p>

<div style="text-align: center; margin-bottom: 1rem;">
  <img src="{{qrCodeDataUrl}}" alt="TOTP QR Code" style="width: 200px; height: 200px;">
</div>

<div style="background: #f3f4f6; border-radius: 6px; padding: 0.75rem; margin-bottom: 1.25rem; text-align: center;">
  <p style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.25rem;">Or enter this code manually:</p>
  <code style="font-size: 0.9rem; font-weight: 600; letter-spacing: 0.1rem;">{{secret}}</code>
</div>

<form method="POST" action="/realms/{{realmName}}/account/totp-verify" class="auth-form">
  <div class="form-group">
    <label for="code">Enter the 6-digit code to verify</label>
    <input type="text" id="code" name="code" pattern="[0-9]{6}" maxlength="6" inputmode="numeric" required autofocus
      style="text-align: center; font-size: 1.5rem; letter-spacing: 0.5rem;">
  </div>

  <button type="submit" class="btn-primary">Verify & Activate</button>
</form>

<div style="margin-top: 1rem; text-align: center;">
  <a href="/realms/{{realmName}}/account" style="color: #6b7280; font-size: 0.85rem;">Cancel</a>
</div>
{{/if}}
